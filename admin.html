<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Fleet App - Admin</title>
  <style></style>

</head>
<body>

 
  <header class="navbar">
    <h2 class="brand">Fleet Management Dashboard</h2>

    <div class="nav-right">
      <select id="filterCategory" class="nav-select">
        <option value="All">All Categories</option>
        <option>Auto</option>
        <option>Car</option>
        <option>Truck</option>
        <option>Bus</option>
      </select>

      <select id="filterAvailability" class="nav-select">
        <option value="All">All Availability</option>
        <option value="Available">Available</option>
        <option value="Unavailable">Unavailable</option>
      </select>

      <button id="clearFilters" class="btn small">Clear</button>
    </div>
  </header>

  <!-- MAIN LAYOUT -->
  <div class="container">

    <!-- Sidebar -->
    <aside class="sidebar card">
      <h3>Add Fleet Vehicle</h3>

      <form id="fleetForm">
        <label>Reg No
          <input type="text" id="regNo" placeholder="MH12AB1234" required>
        </label>

        <label>Category
          <select id="category" required>
            <option value="">Select Category</option>
            <option>Auto</option>
            <option>Car</option>
            <option>Truck</option>
            <option>Bus</option>
          </select>
        </label>

        <label>Driver Name
          <input type="text" id="driverName" placeholder="Driver Name" required>
        </label>

        <label class="checkbox">
          <input type="checkbox" id="isAvailable" checked>
          Available
        </label>

        <button type="submit" class="btn full">Add Fleet</button>
      </form>
    </aside>

    <!-- Main Content -->
    <main class="main-area">
      <div id="fleetGrid" class="cards-grid"></div>
      <p id="emptyMsg" class="muted" style="display:none; margin-top:12px;">No vehicles to show â€” add some from the left.</p>
    </main>

  </div>

</body>


<script>


(function() {
  
  const VEHICLE_IMG_SRC = 'https://coding-platform.s3.amazonaws.com/dev/lms/tickets/5e80fcb6-3f8e-480c-945b-30a5359eb40e/JNmYjkVr3WOjsrbu.png';

  const STORAGE_KEY = 'fleet_v1';

  // DOM refs
  const fleetForm = document.getElementById('fleetForm');
  const regNoInput = document.getElementById('regNo');
  const categoryInput = document.getElementById('category');
  const driverInput = document.getElementById('driverName');
  const isAvailableInput = document.getElementById('isAvailable');

  const fleetGrid = document.getElementById('fleetGrid');
  const emptyMsg = document.getElementById('emptyMsg');

  const filterCategory = document.getElementById('filterCategory');
  const filterAvailability = document.getElementById('filterAvailability');
  const clearFiltersBtn = document.getElementById('clearFilters');

  // load initial data from localStorage
  let fleetData = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');

  // helper: persist
  function save() {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(fleetData));
  }

  // helper: escape
  function esc(s) {
    if (s === undefined || s === null) return '';
    return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
  }

  // create card DOM for a vehicle
  function createCard(vehicle) {
    const card = document.createElement('div');
    card.className = 'fleet-card';

    card.innerHTML = `
      <img src="${VEHICLE_IMG_SRC}" alt="vehicle image" class="vehicle-img">
      <div class="card-body">
        <div class="card-row"><strong>Reg No:</strong> <span class="muted">${esc(vehicle.regNo)}</span></div>
        <div class="card-row"><strong>Category:</strong> <span class="muted">${esc(vehicle.category)}</span></div>
        <div class="card-row"><strong>Driver:</strong> <span class="muted driver-name">${esc(vehicle.driverName)}</span></div>
        <div class="card-row"><strong>Availability:</strong> <span class="status">${vehicle.isAvailable ? 'Available' : 'Unavailable'}</span></div>
      </div>
      <div class="card-actions">
        <button class="btn tiny update-driver">Update Driver</button>
        <button class="btn tiny toggle-availability">${vehicle.isAvailable ? 'Mark Unavailable' : 'Mark Available'}</button>
        <button class="btn tiny danger delete-vehicle">Delete Vehicle</button>
      </div>
    `;

    // events
    card.querySelector('.update-driver').addEventListener('click', () => {
      const newName = prompt('Enter new driver name:', vehicle.driverName || '');
      if (newName === null) return; // cancelled
      if (newName.trim() === '') {
        alert('Driver name cannot be empty.');
        return;
      }
      const idx = fleetData.findIndex(v => v.id === vehicle.id);
      if (idx !== -1) {
        fleetData[idx].driverName = newName.trim();
        save();
        render();
      }
    });

    card.querySelector('.toggle-availability').addEventListener('click', () => {
      const idx = fleetData.findIndex(v => v.id === vehicle.id);
      if (idx !== -1) {
        fleetData[idx].isAvailable = !fleetData[idx].isAvailable;
        save();
        render();
      }
    });

    card.querySelector('.delete-vehicle').addEventListener('click', () => {
      const ok = confirm('Are you sure you want to delete this vehicle?');
      if (!ok) return;
      fleetData = fleetData.filter(v => v.id !== vehicle.id);
      save();
      render();
    });

    return card;
  }

  // render grid with filters applied
  function render() {
    const catFilter = filterCategory.value;
    const availFilter = filterAvailability.value;

    const filtered = fleetData.filter(v => {
      let ok = true;
      if (catFilter && catFilter !== 'All') ok = ok && (v.category === catFilter);
      if (availFilter && availFilter !== 'All') ok = ok && ((v.isAvailable ? 'Available' : 'Unavailable') === availFilter);
      return ok;
    });

    fleetGrid.innerHTML = '';
    if (filtered.length === 0) {
      emptyMsg.style.display = 'block';
    } else {
      emptyMsg.style.display = 'none';
    }

    filtered.forEach(v => {
      const card = createCard(v);
      fleetGrid.appendChild(card);
    });
  }

  // form submit
  fleetForm.addEventListener('submit', function(e) {
    e.preventDefault();

    const regNo = regNoInput.value.trim();
    const category = categoryInput.value;
    const driverName = driverInput.value.trim();
    const isAvailable = !!isAvailableInput.checked;

    // validation
    if (!regNo) { alert('Reg No is required.'); return; }
    if (!category) { alert('Please select a category.'); return; }
    if (!driverName) { alert('Driver name is required.'); return; }

    // create vehicle
    const vehicle = {
      id: Date.now().toString() + Math.random().toString(36).slice(2,6),
      regNo, category, driverName, isAvailable
    };

    fleetData.push(vehicle);
    save();

    // clear form
    fleetForm.reset();
    isAvailableInput.checked = true;

    render();
  });

  // filters
  filterCategory.addEventListener('change', render);
  filterAvailability.addEventListener('change', render);
  clearFiltersBtn.addEventListener('click', () => {
    filterCategory.value = 'All';
    filterAvailability.value = 'All';
    render();
  });

  // initial render
  render();

  document.addEventListener('keydown', (e) => {
    if (e.ctrlKey && e.shiftKey && e.key.toLowerCase() === 'c') {
      if (confirm('Clear fleet data?')) {
        localStorage.removeItem(STORAGE_KEY);
        fleetData = [];
        render();
        alert('Cleared');
      }
    }
  });
})();



</script>

</html>
 
